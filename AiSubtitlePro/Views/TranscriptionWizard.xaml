<Window x:Class="AiSubtitlePro.Views.TranscriptionWizard"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        Title="AI Transcription Wizard" 
        Height="550" Width="700"
        WindowStartupLocation="CenterOwner"
        ShowInTaskbar="False"
        ResizeMode="NoResize"
        Background="{DynamicResource MaterialDesignPaper}">

    <Grid Margin="24">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Grid.Row="0" Margin="0,0,0,20">
            <TextBlock Text="AI Speech Recognition" FontSize="24" FontWeight="Bold" />
            <TextBlock Text="Automatically transcribe audio to subtitles using Whisper AI (offline)"
                       Foreground="Gray" Margin="0,4,0,0" />
        </StackPanel>

        <!-- Content -->
        <TabControl x:Name="WizardTabs" Grid.Row="1" 
                    Style="{StaticResource MaterialDesignNavigationRailTabControl}">
            
            <!-- Step 1: Select File -->
            <TabItem Header="1. File">
                <Grid Margin="20">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0" Text="Select Media File" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,12" />
                    
                    <Grid Grid.Row="1">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        
                        <TextBox x:Name="FilePathBox" Grid.Column="0" IsReadOnly="True"
                                 materialDesign:HintAssist.Hint="Select a video or audio file..."
                                 Margin="0,0,8,0" />
                        <Button Grid.Column="1" Content="Browse..." Click="BrowseFile_Click" />
                    </Grid>

                    <Border Grid.Row="2" Background="{StaticResource SurfaceBrush}" 
                            CornerRadius="8" Margin="0,16,0,0" Padding="16">
                        <StackPanel>
                            <TextBlock Text="Supported Formats:" FontWeight="SemiBold" Margin="0,0,0,8" />
                            <TextBlock Text="â€¢ Video: MP4, MKV, AVI, MOV, WMV, WebM" Foreground="Gray" />
                            <TextBlock Text="â€¢ Audio: MP3, WAV, FLAC, AAC, M4A" Foreground="Gray" />
                        </StackPanel>
                    </Border>
                </Grid>
            </TabItem>

            <!-- Step 2: Model Selection -->
            <TabItem Header="2. Model">
                <Grid Margin="20">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0" Text="Select Whisper Model" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,12" />

                    <StackPanel Grid.Row="1">
                        <RadioButton x:Name="TinyModel" Content="Tiny (~75MB) - Fast, lower accuracy" Margin="0,4" />
                        <RadioButton x:Name="BaseModel" Content="Base (~150MB) - Good balance" IsChecked="True" Margin="0,4" />
                        <RadioButton x:Name="SmallModel" Content="Small (~500MB) - Better accuracy" Margin="0,4" />
                        <RadioButton x:Name="MediumModel" Content="Medium (~1.5GB) - High accuracy" Margin="0,4" />
                        <RadioButton x:Name="LargeModel" Content="Large (~3GB) - Best accuracy (slow)" Margin="0,4" />

                        <Border Background="{StaticResource SurfaceBrush}" 
                                CornerRadius="8" Margin="0,20,0,0" Padding="16">
                            <StackPanel>
                                <TextBlock Text="ðŸ“¥ Model Download Required" FontWeight="SemiBold" Foreground="Orange" />
                                <TextBlock Text="Models will be downloaded on first use and stored locally for offline use."
                                           TextWrapping="Wrap" Foreground="Gray" Margin="0,4,0,0" />
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </Grid>
            </TabItem>

            <!-- Step 3: Compute -->
            <TabItem Header="3. Compute">
                <Grid Margin="20">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0" Text="Select Compute Backend" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,12" />

                    <StackPanel Grid.Row="1">
                        <RadioButton x:Name="CpuRadio" Content="CPU" IsChecked="True" Margin="0,4" />
                        <RadioButton x:Name="CudaRadio" Content="GPU (CUDA)" Margin="0,4" />
                        <RadioButton x:Name="VulkanRadio" Content="GPU (Vulkan)" Margin="0,4" />
                    </StackPanel>

                    <TextBlock Grid.Row="2" Text="Detected GPUs" Foreground="Gray" Margin="0,16,0,8" />

                    <ListBox Grid.Row="3" x:Name="GpuList" />
                </Grid>
            </TabItem>

            <!-- Step 4: Language -->
            <TabItem Header="4. Language">
                <Grid Margin="20">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0" Text="Select Language" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,12" />

                    <StackPanel Grid.Row="1">
                        <RadioButton x:Name="AutoDetectLang" Content="Auto-detect language" IsChecked="True" Margin="0,4" />
                        <RadioButton Content="Specify language:" Margin="0,4" />
                        
                        <ComboBox x:Name="LanguageCombo" Margin="24,8,0,0" Width="200" HorizontalAlignment="Left">
                            <ComboBoxItem Content="English" Tag="en" IsSelected="True" />
                            <ComboBoxItem Content="Japanese" Tag="ja" />
                            <ComboBoxItem Content="Korean" Tag="ko" />
                            <ComboBoxItem Content="Chinese" Tag="zh" />
                            <ComboBoxItem Content="Vietnamese" Tag="vi" />
                            <ComboBoxItem Content="Thai" Tag="th" />
                            <ComboBoxItem Content="French" Tag="fr" />
                            <ComboBoxItem Content="German" Tag="de" />
                            <ComboBoxItem Content="Spanish" Tag="es" />
                            <ComboBoxItem Content="Russian" Tag="ru" />
                        </ComboBox>
                    </StackPanel>
                </Grid>
            </TabItem>

            <!-- Step 5: Progress -->
            <TabItem Header="5. Transcribe">
                <Grid Margin="20">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0" Text="Transcription Progress" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,12" />

                    <ProgressBar x:Name="ProgressBar" Grid.Row="1" Height="20" Value="0" Margin="0,0,0,8" />
                    
                    <TextBlock x:Name="ProgressText" Grid.Row="2" Text="Ready to start" Foreground="Gray" />

                    <Border Grid.Row="3" Background="{StaticResource SurfaceBrush}" 
                            CornerRadius="8" Margin="0,16,0,0" Padding="16">
                        <ScrollViewer VerticalScrollBarVisibility="Auto">
                            <TextBlock x:Name="LogText" TextWrapping="Wrap" Foreground="Gray"
                                       Text="Transcription log will appear here..." />
                        </ScrollViewer>
                    </Border>
                </Grid>
            </TabItem>
        </TabControl>

        <!-- Footer Buttons -->
        <Grid Grid.Row="2" Margin="0,16,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>

            <Button Grid.Column="0" Content="Cancel" IsCancel="True" Width="100"
                    Style="{StaticResource MaterialDesignOutlinedButton}" />

            <Button x:Name="BackButton" Grid.Column="2" Content="â† Back" Width="100" Margin="0,0,8,0"
                    Click="BackButton_Click"
                    Style="{StaticResource MaterialDesignOutlinedButton}" />
            
            <Button x:Name="NextButton" Grid.Column="3" Content="Next â†’" Width="100"
                    Click="NextButton_Click"
                    Style="{StaticResource MaterialDesignRaisedButton}" />
        </Grid>
    </Grid>
</Window>
